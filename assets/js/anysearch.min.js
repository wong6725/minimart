!function(e){e.fn.anysearch=function(n){return n=e.extend({reactOnKeycodes:"string",secondsBetweenKeypress:2,searchPattern:{1:"[^~,]*"},minimumChars:3,liveField:!1,excludeFocus:"input,textarea,select",enterKey:13,backspaceKey:8,checkIsBarcodeMilliseconds:250,checkBarcodeMinLength:4,searchSlider:!0,startAnysearch:function(){},stopAnysearch:function(){},minimumCharsNotReached:function(e,n,t){},searchFunc:function(e){},patternsNotMatched:function(e,n){},isBarcode:function(e){}},n),this.each(function(){var t=null,i=null,a=[],c=setTimeout(function(){}),r="",s=null;switch(n.reactOnKeycodes){case"string":r="32,48,49,50,51,52,53,54,55,56,57,94,176,33,34,167,36,37,38,47,40,41,61,63,96,180,223,178,179,123,91,93,125,92,113,119,101,114,116,122,117,105,111,112,252,43,35,228,246,108,107,106,104,103,102,100,115,97,60,121,120,99,118,98,110,109,44,46,45,81,87,69,82,84,90,85,73,79,80,220,42,65,83,68,70,71,72,74,75,76,214,196,39,62,89,88,67,86,66,78,77,59,58,95,64,8364,126,35,124,181";break;case"numeric":r="43,45,48,49,50,51,52,53,54,55,56,57";break;case"all":r="all";break;default:r=n.reactOnKeycodes}if("all"!==r)var o=r.replace(/\s/g,"").split(",").map(function(e){return parseInt(e)});var h=function(e,t){return void 0===t&&(t=n.secondsBetweenKeypress),(new Date).getTime()-e<=1e3*t},u=function(){a=null,a=[],i=null,t=null,clearTimeout(c),c=setTimeout(function(){}),s=null},l=function(e){n.searchFunc(e)},d=function(){var t=!1,i=n.excludeFocus.split(",");return e.each(i,function(n,i){if(e(""+e.trim(i)).is(":focus"))return t=!0}),t},y=function(t){var i=!1;return e.each(n.searchPattern,function(e,n){if(new RegExp(n).test(t))return i=!0}),!1===i&&n.patternsNotMatched(t,n.searchPattern),i},f=function(e,t,i,a){return a-i<n.checkIsBarcodeMilliseconds&&e.length>=n.checkBarcodeMinLength*t},p=function(e){return e.length>=n.minimumChars||(n.minimumCharsNotReached(e,e.length,n.minimumChars),!1)},m=function(t){var i=String.fromCharCode.apply(String,t);if(!0===n.searchSlider&&e("#anysearch-input").val(i),!1!==n.liveField&&null!==n.liveField.selector){if(!0===n.liveField.html)return void e(""+n.liveField.selector).html(i);if(!0===n.liveField.value)return void e(""+n.liveField.selector).val(i);if(null!==n.liveField.attr)return void e(""+n.liveField.selector).attr(n.liveField.attr,i)}},v=function(){var e=function(){var e=String.fromCharCode.apply(String,a);return f(e,1,t,i)&&n.isBarcode(e),e}();e.length>=1&&(!0===y(e)&&p(e)&&l(e),u(),m(a),n.stopAnysearch(),!0===n.searchSlider&&x())},b=function(e){!function(e){e&&e.preventDefault?e.preventDefault():e.returnValue=!1,a.pop()}(e),m(a)},g=function(){clearTimeout(c),c=setTimeout(function(){x()},1e3*n.secondsBetweenKeypress)};if(e(this).keydown(function(e){!1===d()&&(!h(i)||e.which!==n.enterKey&&e.which!==n.backspaceKey||(i=(new Date).getTime(),e.which===n.enterKey&&(clearTimeout(c),v()),e.which===n.backspaceKey&&(!0===n.searchSlider&&g(),b(e))))}),e(this).keypress(function(e){!1===d()&&e.which!==n.backspaceKey&&e.which!==n.enterKey&&function(e){return"all"===r||jQuery.inArray(e.which,o)>=0}(e)&&(h(i)||null===i?(!0===n.searchSlider&&w(),null===i&&e.which!==n.enterKey&&e.which!==n.backspaceKey&&(t=(new Date).getTime(),n.startAnysearch()),i=(new Date).getTime(),a.push(e.which),m(a)):(u(),m(a),a.push(e.which),m(a)),!0===n.searchSlider&&g())}),!0===n.searchSlider){function w(){setTimeout(function(){var n=e("#anysearch-slidebox").find("#anysearch-sidebutton");e(n).hasClass("anysearchIsOpen")||(e("#anysearch-slidebox").animate({right:"0px"},300),e(n).addClass("anysearchIsOpen"))},25)}function x(){setTimeout(function(){var n=e("#anysearch-slidebox").find("#anysearch-sidebutton");e(n).hasClass("anysearchIsOpen")&&(e("#anysearch-slidebox").stop(!0).animate({right:"-"+e("#anysearch-slidebox-content").outerWidth()},100),e(n).removeClass("anysearchIsOpen"),u(),e("#anysearch-input").val("").blur())},25)}e('<div id="anysearch-slidebox"><div id="anysearch-slidebox-button"><button id="anysearch-sidebutton"><i class="anysearch-icon"></i></button></div><div id="anysearch-slidebox-content"><input id="anysearch-input" type="text" placeholder="Suchen..."></div></div>').appendTo("body"),e("#anysearch-slidebox").css("right","-"+e("#anysearch-slidebox-content").outerWidth()+"px"),e(this).bind("click",function(n){e(n.target).is("#anysearch-input")||e(n.target).is("#anysearch-sidebutton")||e(n.target).is("#anysearch-slidebox-button")||e(n.target).is("#anysearch-slidebox")||e(n.target).is("#anysearch-slidebox-content")||x()}),e("#anysearch-sidebutton").click(function(){e(this).hasClass("anysearchIsOpen")?x():(e("#anysearch-input").focus(),w())}),e("#anysearch-input").keydown(function(t){if(null===s&&13!==t.which&&(s=(new Date).getTime(),n.startAnysearch()),13===t.which){var i=e(this).val(),a=(new Date).getTime();f(i,1,s,a)&&n.isBarcode(i),s=null,i.length>=1&&!0===y(i)&&p(i)&&(l(i),x()),n.stopAnysearch()}}),e("#anysearch-input").focus(function(){clearTimeout(c)})}})}}(jQuery);